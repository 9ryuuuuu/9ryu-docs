# ユークリッドの互除法の基本的な性質

以下では、2つの整数 a と b の最大公約数 (gcd) を求めるアルゴリズムであるユークリッドの互除法について、なぜ

```
gcd(a, b) = gcd(b, a mod b)
```

となるのか、その理由を詳しく説明します。

---

## 1. 割り算の基本

まず、a を b で割ったとき、商 q と余り r が存在し、次のように表されます:

```
a = bq + r   (ただし 0 ≤ r < b)
```

ここで、a mod b は余り r を意味します。

---

## 2. 共通の約数と線形結合の性質（詳細説明）

まず、「d が a と b の共通の約数である」というのは、d が a を割り切り、かつ d が b も割り切るということです。すなわち、a と b はそれぞれ

$$
a = d \times A,\quad b = d \times B
$$

という形で表せ、ここで A と B は整数になります。

次に、a と b の線形結合とは、a と b に任意の整数を掛けたものの和のことです。例えば、ある整数 q と r に対して、以下のように書けます。

$$
a = bq + r
$$

この式は、a を b で割ったときの定義式で、q は商、r は余り（つまり a mod b）です。ここで重要なのは、d が a と b の共通の約数ならば、d は a も b も割り切るという事実です。

それでは、この性質を使って次のことを考えます。

1. **d が a と b の両方を割り切る場合**  
   すでに a = d × A, b = d × B と書けるので、a と b のどちらも d の倍数です。

2. **線形結合 a = bq + r に d を適用する場合**  
   ここで、d は b を割り切るので、d は b に q を掛けた bq も割り切ります。  
   すると、a から bq を引いた r も割り切らなければなりません。  
   つまり、もし d が a と b の共通約数なら、d は必ず余り r も割り切ります。

3. **逆の立場で考える場合**  
   もし d が b と r の共通約数であれば、d は b を割り切り、かつ r も割り切るので、d は bq（q は任意の整数）も割り切ります。  
   そのため、a = bq + r の全体も d の倍数となり、d は a と b の共通約数となります。

このように、a と b の共通約数は必ず r も割り切り、また r と b の共通約数が a も割り切るという関係が成り立つため、  
$$
\gcd(a, b) = \gcd(b, a \mod b)
$$  
という等式が成立します。

この性質がユークリッドの互除法の基礎となっており、余りが 0 になるまでこの手順を繰り返すことで、最大公約数 (gcd) を求めることができるのです.

---

## 3. 結果としての性質

上記のことから、

- a と b の全ての共通約数は b と r の共通約数でもあり、
- b と r の全ての共通約数は a と b の共通約数でもある。

したがって、最大公約数は同じになり、

```
gcd(a, b) = gcd(b, a mod b)
```

が成立します。

---

## 4. アルゴリズムへの応用

この性質を利用してユークリッドの互除法は次のように動作します:

1. r = a mod b を計算する。
2. r = 0 なら、gcd(a, b) は b である。
3. r ≠ 0 なら、gcd(a, b) = gcd(b, r) として同じ手順を繰り返す。

これにより、最終的に余りが 0 になったときの除数が gcd(a, b) となります。

---

このように、割り算の性質と共通約数の性質から、gcd(a, b) = gcd(b, a mod b) が成り立つ理由が説明できます。



