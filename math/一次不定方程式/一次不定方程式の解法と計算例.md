
# 一次不定方程式の解法

このドキュメントでは、一次不定方程式の整数解の存在条件、特殊解の求め方、一般解の導出、その例について詳しく解説します。

---

## 1. 方程式と整数解の存在条件

一次不定方程式は  
$$
ax+by=c
$$  
の形をしており、ここで $a$, $b$, $c$ は既知の整数、$x$ と $y$ は未知数です。この方程式に整数解が存在するための必要条件は、

$$
\gcd(a,b) \mid c
$$

すなわち、$a$ と $b$ の最大公約数が $c$ を割り切ることです。  
**理由：**  
任意の整数 $x$ と $y$ に対して $ax+by$ は必ず $\gcd(a,b)$ の倍数になるため、もし $c$ が $\gcd(a,b)$ の倍数でなければ解は存在しません。

### 計算例 1: $3x+5y=1$ の場合

1. $\gcd(3,5)=1$ なので、$1$ は $1$ の倍数です。よって解は存在します。

---

## 2. 特殊解の求め方（拡張ユークリッドの互除法）

解が存在するとき、拡張ユークリッドの互除法を用いると、

$$
ax_0+by_0=\gcd(a,b)
$$

を満たす整数 $x_0$ と $y_0$ を求められます。  
もし $d=\gcd(a,b)$ で $c$ が $d$ の倍数、すなわち $c=dk$ と表せるなら、

$$
x=x_0k,\quad y=y_0k
$$

は方程式

$$
ax+by=c
$$

の**特殊解**となります。

### 計算例 1（続き）: $3x+5y=1$

- 拡張ユークリッドの互除法を用いると、  
  $$
  3\cdot2+5\cdot(-1)=6-5=1,
  $$
  よって特殊解として $x_0=2$, $y_0=-1$ が得られます。  
- $c=1$ は $\gcd(3,5)=1$ の $1$ 倍なので、$k=1$ として、  
  $$
  x=2\cdot1=2,\quad y=(-1)\cdot1=-1.
  $$

この結果、特殊解 $(x,y)=(2,-1)$ が得られます。

### 計算例 2: $12x+18y=30$ の場合

1. まず、$\gcd(12,18)=6$ です。
2. $30$ は $6$ の倍数で、$30=6\cdot5$ よって $k=5$ となります。
3. 拡張ユークリッドの互除法で $12$ と $18$ の最大公約数を表す係数を求めます。  
   例として、  
   $$
   12\cdot(-1)+18\cdot1=6,
   $$
   とすると、特殊解として $x_0=-1$, $y_0=1$ が得られます。
4. これに $k=5$ を掛けると、  
   $$
   x=-1\cdot5=-5,\quad y=1\cdot5=5.
   $$
5. 確認: $12(-5)+18(5)=-60+90=30$ となり、正しいことがわかります。

---

## 3. 一般解の導出

特殊解 $(x_0,y_0)$ が求まった後、すべての解はこの特殊解に同次方程式

$$
a(x-x_0)+b(y-y_0)=0
$$

の解を加えることで表されます。  
この同次方程式の整数解は、

$$
x-x_0 = \frac{b}{d}\,t,\quad y-y_0 = -\frac{a}{d}\,t \quad (t\in\mathbb{Z})
$$

となるため、**一般解**は

$$
x = x_0 + \frac{b}{d}\,t,\quad y = y_0 - \frac{a}{d}\,t\quad (t\in\mathbb{Z})
$$

と表されます。

### 計算例 1（続き）: $3x+5y=1$ の一般解

- ここで $d=\gcd(3,5)=1$ なので、
  $$
  x=2+5t,\quad y=-1-3t,\quad (t\in\mathbb{Z})
  $$
  
  これが $3x+5y=1$ の全ての整数解を表す一般解です。

### 計算例 2（続き）: $12x+18y=30$ の一般解

- $d=\gcd(12,18)=6$ のため、特殊解 $(x_0,y_0)=(-5,5)$ に対して、  
  $$
  x = -5 + \frac{18}{6}\,t = -5 + 3t,\quad y = 5 - \frac{12}{6}\,t = 5 - 2t,\quad (t\in\mathbb{Z})
  $$

  これが $12x+18y=30$ の全ての整数解を表す一般解です。

---

## 4. まとめ

1. **整数解の存在条件：**  
   一次不定方程式  
   $$
   ax+by=c
   $$
   に整数解が存在するためには、  
   $$
   \gcd(a,b) \mid c
   $$
   すなわち、$a$ と $b$ の最大公約数が $c$ の倍数でなければなりません。

2. **特殊解の求め方：**  
   拡張ユークリッドの互除法を用いて
   $$
   ax_0+by_0=\gcd(a,b)
   $$
   を求め、$c$ をその倍数（$c=d\,k$）として、
   $$
   x=x_0k,\quad y=y_0k
   $$
   で特殊解が得られます。  
   - 例: $3x+5y=1$ の特殊解は $(2,-1)$。  
   - 例: $12x+18y=30$ の特殊解は $(-5,5)$。

3. **一般解の導出：**  
   特殊解 $(x_0,y_0)$ に対し、任意の解との差
   $$
   \Delta x = x-x_0,\quad \Delta y = y-y_0
   $$
   は同次方程式
   $$
   a\Delta x + b\Delta y = 0
   $$
   の解となります。  
   この同次方程式の整数解は、
   $$
   \Delta x = \frac{b}{d}\,t,\quad \Delta y = -\frac{a}{d}\,t \quad (t\in\mathbb{Z})
   $$
   と表されるため、全体の一般解は
   $$
   x=x_0+\frac{b}{d}\,t,\quad y=y_0-\frac{a}{d}\,t\quad (t\in\mathbb{Z})
   $$
   となります.  
   - 例: $3x+5y=1$ の一般解は $x=2+5t$, $y=-1-3t$.  
   - 例: $12x+18y=30$ の一般解は $x=-5+3t$, $y=5-2t$.

このように、特殊解と同次方程式の解を組み合わせることで、一次不定方程式の全ての整数解を求めることができます。
